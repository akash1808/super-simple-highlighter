var _tabs={executeScripts:function(tabId,injectDetailsArray,finalCallback){"use strict";function createCallback(tabId,injectDetails,innerCallback){return function(){chrome.tabs.executeScript(tabId,injectDetails,innerCallback)}}var i,callback=finalCallback;for(i=injectDetailsArray.length-1;i>=0;--i)callback=createCallback(tabId,injectDetailsArray[i],callback);callback&&callback()},executeAllScripts:function(tabId,allFrames,callback){"use strict";(void 0===allFrames||null===allFrames)&&(allFrames=!1);var injectDetailsArray=[];["static/js/jquery-2.1.3.min.js","static/js/jquery.stylesheet.min.js","js/storage.js","js/string_utils.js","js/stylesheet.js","js/content_script/xpath.js","js/content_script/highlighter.js","js/content_script/content_script.js"].forEach(function(file){injectDetailsArray.push({file:file,allFrames:allFrames})}),_tabs.executeScripts(tabId,injectDetailsArray,callback)},sendMessage:function(tabId,message,responseCallback){"use strict";chrome.tabs.sendMessage(tabId,message,function(response){void 0===response?_tabs.executeAllScripts(tabId,!1,function(){chrome.tabs.sendMessage(tabId,message,responseCallback)}):responseCallback&&responseCallback(response)})},sendCreateHighlightMessage:function(tabId,range,className,documentId,responseCallback){"use strict";_tabs.sendMessage(tabId,{id:"create_highlight",range:range,highlightId:documentId,className:className},responseCallback)},sendUpdateHighlightMessage:function(tabId,documentId,className,responseCallback){"use strict";_tabs.sendMessage(tabId,{id:"update_highlight",highlightId:documentId,className:className},responseCallback)},sendDeleteHighlightMessage:function(tabId,documentId,responseCallback){"use strict";_tabs.sendMessage(tabId,{id:"delete_highlight",highlightId:documentId},responseCallback)},sendGetSelectionRangeMessage:function(tabId,responseCallback){"use strict";_tabs.sendMessage(tabId,{id:"get_selection_range"},responseCallback)},sendGetRangeTextMessage:function(tabId,xpathRange,responseCallback){"use strict";_tabs.sendMessage(tabId,{id:"get_range_text",range:xpathRange},responseCallback)},sendSelectHighlightTextMessage:function(tabId,documentId,responseCallback){"use strict";var message={id:"select_highlight"};documentId&&(message.highlightId=documentId),_tabs.sendMessage(tabId,message,responseCallback)},sendIsHighlightInDOMMessage:function(tabId,documentId,responseCallback){"use strict";_tabs.sendMessage(tabId,{id:"is_highlight_in_dom",highlightId:documentId},responseCallback)},sendScrollToMessage:function(tabId,documentId,responseCallback){"use strict";_tabs.sendMessage(tabId,{id:"scroll_to",fragment:documentId},responseCallback)},replayDocuments:function(tabId,docs,errorCallback){"use strict";var sum=0;return docs.forEach(function(doc){switch(doc.verb){case"create":sum++,_tabs.sendCreateHighlightMessage(tabId,doc.range,doc.className,doc._id,function(response){errorCallback&&response!==!0&&errorCallback(doc)});break;case"delete":sum--,_tabs.sendDeleteHighlightMessage(tabId,doc.correspondingDocumentId,function(response){errorCallback&&response!==!0&&errorCallback(doc)})}}),sum}};